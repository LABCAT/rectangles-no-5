{"version":3,"sources":["js/helpers/Globals.js","js/functions/PlayIcon.js","audio/rectangles-no-5.ogg","audio/rectangles-no-5.mid","js/P5SketchWithAudio.js","js/App.js","index.js"],"names":["window","p5","PlayIcon","id","className","xmlns","height","viewBox","width","d","fill","P5SketchWithAudio","sketchRef","useRef","Sketch","p","canvas","canvasWidth","innerWidth","canvasHeight","innerHeight","audioLoaded","player","PPQ","loadMidi","Midi","fromUrl","midi","then","result","noteSet1","tracks","notes","scheduleCueSet","document","getElementById","classList","add","remove","preload","song","loadSound","audio","onended","logCredits","noteSet","callbackName","poly","lastTicks","currentCue","i","length","note","ticks","time","addCue","setup","createCanvas","rc","rough","noLoop","colorMode","HSB","rectMode","CENTER","draw","isPlaying","rects","executeCueSet1","duration","delayMultiplier","heightDivisor","random","fillStyle","Math","colourScheme","clear","x","y","count","colour","color","push","toString","shuffle","delay","rect","setTimeout","rectangle","roughness","overlay","find","centralRect","fillColour","fillHue","_getHue","strokeHue","strokeColour","_getSaturation","_getBrightness","strokeSize","strokeWeight","stroke","midX","midY","hasStarted","mousePressed","pause","parseInt","currentTime","buffer","reset","dataLayer","title","location","href","addClass","play","creditsLogged","console","log","stop","updateCanvasDimensions","resizeCanvas","attachEvent","addEventListener","useEffect","current","ref","App","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.99ecf43a.chunk.js","sourcesContent":["// p5.sound doesn't work correctly when p5 is not available in the global name space so we add it here\n// https://github.com/processing/p5.js-sound/issues/512\nimport * as p5 from \"p5\";\nwindow.p5 = p5;\n","export default function PlayIcon() {\n    return (\n        <svg id=\"play-icon\" className='fade-out' xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" />\n        </svg>\n    )\n}\n","export default __webpack_public_path__ + \"static/media/rectangles-no-5.4fa95595.ogg\";","export default __webpack_public_path__ + \"static/media/rectangles-no-5.3b33c41b.mid\";","import React, { useRef, useEffect } from \"react\";\nimport rough from \"../../node_modules/roughjs/bundled/rough.cjs.js\";\nimport \"./helpers/Globals\";\nimport \"p5/lib/addons/p5.sound\";\nimport * as p5 from \"p5\";\nimport { Midi } from '@tonejs/midi'\nimport PlayIcon from './functions/PlayIcon.js';\n\nimport audio from \"../audio/rectangles-no-5.ogg\";\nimport midi from \"../audio/rectangles-no-5.mid\";\n\nconst P5SketchWithAudio = () => {\n    const sketchRef = useRef();\n\n    const Sketch = p => {\n\n        p.canvas = null;\n\n        p.canvasWidth = window.innerWidth;\n\n        p.canvasHeight = window.innerHeight;\n\n        p.audioLoaded = false;\n\n        p.player = null;\n\n        p.PPQ = 3840 * 4;\n\n        p.loadMidi = () => {\n            Midi.fromUrl(midi).then(\n                function(result) {\n                    const noteSet1 = result.tracks[1].notes; // Sampler 2 - W-80's Synth\n                    p.scheduleCueSet(noteSet1, 'executeCueSet1');\n                    p.audioLoaded = true;\n                    document.getElementById(\"loader\").classList.add(\"loading--complete\");\n                    document.getElementById(\"play-icon\").classList.remove(\"fade-out\");\n                }\n            );\n            \n        }\n\n        p.preload = () => {\n            p.song = p.loadSound(audio, p.loadMidi);\n            p.song.onended(p.logCredits);\n        }\n\n        p.scheduleCueSet = (noteSet, callbackName, poly = false)  => {\n            let lastTicks = -1,\n                currentCue = 1;\n            for (let i = 0; i < noteSet.length; i++) {\n                const note = noteSet[i],\n                    { ticks, time } = note;\n                if(ticks !== lastTicks || poly){\n                    note.currentCue = currentCue;\n                    p.song.addCue(time, p[callbackName], note);\n                    lastTicks = ticks;\n                    currentCue++;\n                }\n            }\n        } \n\n        p.setup = () => {\n            p.canvas = p.createCanvas(p.canvasWidth, p.canvasHeight);\n            p.rc = rough.canvas(document.getElementById('defaultCanvas0'));\n            p.noLoop();\n            p.colorMode(p.HSB);\n            p.rectMode(p.CENTER);\n        }\n\n        p.draw = () => {\n            if(p.audioLoaded && p.song.isPlaying()){\n\n            }\n        }\n\n        p.rects = [];\n\n\n        p.executeCueSet1 = (note) => {\n            const { duration, currentCue } = note,\n                delayMultiplier = duration > 1 ? 0.8 : 0.6,\n                heightDivisor =  duration < 1 ? p.random(4, 12) : p.random([16, 24, 36]),\n                height = p.height / heightDivisor,\n                fillStyle = heightDivisor > 12 \n                    ? (Math.random() > 0.15 ? p.random(['hachure', 'cross-hatch']) : 'solid')\n                    : p.random(['zigzag', 'cross-hatch', 'sunburst', 'dashed', 'zigzag-line']),\n                colourScheme = fillStyle === 'solid' \n                    ? 'tetradic'\n                    : p.random(['random', 'tetradic', 'rainbow']);\n            \n            p.clear();\n            p.rects = [];\n\n            let x = p.random(-height / 2, 0);\n            let y = p.random(-height / 2, 0);\n            let count = 0;\n            while(y < p.height) {\n                while (x < p.width) {\n                    let width = p.random(height * 1.5, height * 2),\n                        colour = '';\n                    if(colourScheme === 'random') {\n                        colour = p.color(\n                            p.random(0, 360),\n                            p.random(50, 100),\n                            p.random(50, 100)\n                        );\n                    } \n                    else if(colourScheme === 'tetradic') {\n                        colour = p.color(\n                            count % 4 * 90,\n                            75, \n                            75\n                        );\n                    } \n                    else {\n                        colour = p.color(\n                            count % 6 * 60,\n                            p.random(25, 100),\n                            p.random(25, 100)\n                        );\n                    }\n                    \n                    p.rects.push(\n                        {\n                            x: x, \n                            y: y, \n                            width: width * 0.9, \n                            height: height * 0.9,\n                            colour: colour.toString(),\n                            fillStyle: fillStyle\n                        }\n                    );\n                    count++;\n                    x = x + width;\n                }\n                x = p.random(-height/2, 0);\n                y = y + height;\n            }\n\n            p.rects = p.shuffle(p.rects);\n            const delay = (duration * 1000 / p.rects.length) * delayMultiplier;\n            for (let i = 0; i < p.rects.length; i++) {\n                const rect = p.rects[i],\n                    { x, y, width, height, colour, fillStyle } = rect;\n                setTimeout(\n                    function () {\n                        p.rc.rectangle(\n                            x, \n                            y, \n                            width, \n                            height,\n                            { \n                                roughness: p.random(1, 2.5),\n                                fill: colour,\n                                fillStyle: fillStyle\n                            }\n                        );\n                    },\n                    (delay * i)\n                );\n            }\n\n            if(currentCue > 60) {\n                const overlay = p.rects.find(p.centralRect),\n                    fillColour = p.color(overlay.colour),\n                    fillHue = fillColour._getHue(),\n                    strokeHue = fillHue + 180 > 360 ? fillHue - 180 : fillHue + 180,\n                    strokeColour = p.color(strokeHue, fillColour._getSaturation(), fillColour._getBrightness()),\n                    strokeSize = (currentCue % 20) ? p.width / (22 - (currentCue % 20)) : p.width / 2;\n\n                p.strokeWeight(strokeSize);\n                p.stroke(strokeColour);\n                p.fill(fillColour);\n                \n                p.rect(\n                    p.width / 2, \n                    p.height / 2, \n                    p.width, \n                    p.height,\n                );          \n            }\n        }\n\n        p.centralRect = (rect) => {\n            const midX = p.width / 2,\n                midY = p.height / 2,\n                divisor = 4;\n\n            return rect.x < midX + midX / divisor \n                && rect.x > midX - midX / divisor\n                && rect.y < midY + midY / divisor\n                && rect.y > midY - midY / divisor; \n        }\n\n        p.hasStarted = false;\n\n        p.mousePressed = () => {\n            if(p.audioLoaded){\n                if (p.song.isPlaying()) {\n                    p.song.pause();\n                } else {\n                    if (parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)) {\n                        p.reset();\n                        if (typeof window.dataLayer !== typeof undefined){\n                            window.dataLayer.push(\n                                { \n                                    'event': 'play-animation',\n                                    'animation': {\n                                        'title': document.title,\n                                        'location': window.location.href,\n                                        'action': 'replaying'\n                                    }\n                                }\n                            );\n                        }\n                    }\n                    document.getElementById(\"play-icon\").classList.add(\"fade-out\");\n                    p.canvas.addClass(\"fade-in\");\n                    p.song.play();\n                    if (typeof window.dataLayer !== typeof undefined && !p.hasStarted){\n                        window.dataLayer.push(\n                            { \n                                'event': 'play-animation',\n                                'animation': {\n                                    'title': document.title,\n                                    'location': window.location.href,\n                                    'action': 'start playing'\n                                }\n                            }\n                        );\n                        p.hasStarted = false\n                    }\n                }\n            }\n        }\n\n        p.creditsLogged = false;\n\n        p.logCredits = () => {\n            if (\n                !p.creditsLogged &&\n                parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)\n            ) {\n                p.creditsLogged = true;\n                    console.log(\n                    \"Music By: http://labcat.nz/\",\n                    \"\\n\",\n                    \"Animation By: https://github.com/LABCAT/\"\n                );\n                p.song.stop();\n            }\n        };\n\n        p.reset = () => {\n\n        }\n\n        p.updateCanvasDimensions = () => {\n            p.canvasWidth = window.innerWidth;\n            p.canvasHeight = window.innerHeight;\n            p.canvas = p.resizeCanvas(p.canvasWidth, p.canvasHeight);\n        }\n\n        if (window.attachEvent) {\n            window.attachEvent(\n                'onresize',\n                function () {\n                    p.updateCanvasDimensions();\n                }\n            );\n        }\n        else if (window.addEventListener) {\n            window.addEventListener(\n                'resize',\n                function () {\n                    p.updateCanvasDimensions();\n                },\n                true\n            );\n        }\n        else {\n            //The browser does not support Javascript event binding\n        }\n    };\n\n    useEffect(() => {\n        new p5(Sketch, sketchRef.current);\n    }, []);\n\n    return (\n        <div ref={sketchRef}>\n            <PlayIcon />\n        </div>\n    );\n};\n\nexport default P5SketchWithAudio;\n","import P5SketchWithAudio from './P5SketchWithAudio'\n\nfunction App() {\n  return (\n    <P5SketchWithAudio/>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/build.css';\nimport App from './js/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}